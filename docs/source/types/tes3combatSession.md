# tes3combatSession
<div class="search_terms" style="display: none">tes3combatsession, combatsession</div>

<!---
	This file is autogenerated. Do not edit this file manually. Your changes will be ignored.
	More information: https://github.com/MWSE/MWSE/tree/master/docs
-->

A structure that keeps track of combat session data that lasts for the duration of combat. It is mainly used for AI decision making. It is not saved to a savegame.

## Properties

### `alchemyPriority`
<div class="search_terms" style="display: none">alchemypriority</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `castableSpells`
<div class="search_terms" style="display: none">castablespells</div>

The list of castable spells that the AI will consider using during combat. This includes both offensive and defensive spells. It is initialized at the start of combat and may be changed by mods at any time. Like other combat session data, it is not saved to a savegame.

This is actually a list collection type. You can use these methods on castableSpells:

castableSpells:add(tes3spell)
castableSpells:find(tes3spell) -> index
castableSpells:erase(index)
castableSpells:clear()

Note that ids cannot be used with these methods.


**Returns**:

* `result` ([tes3spell](../types/tes3spell.md)[])

***

### `data`
<div class="search_terms" style="display: none">data</div>

A generic lua table that data can be written to, and synced to/from the save. All information stored must be valid for serialization to json.

There is a guide available [here](https://mwse.github.io/MWSE/guides/storing-data/) on using this table.

**Returns**:

* `result` (table)

***

### `distance`
<div class="search_terms" style="display: none">distance</div>

The combat distance.

**Returns**:

* `result` (number)

***

### `lastUseTimestamp`
<div class="search_terms" style="display: none">lastusetimestamp</div>

Used by the MCP to implement an alchemy use cooldown for actor AI.

**Returns**:

* `result` (number)

***

### `mobile`
<div class="search_terms" style="display: none">mobile</div>

*Read-only*. Convenience access back to the associated actor.

**Returns**:

* `result` ([tes3mobileActor](../types/tes3mobileActor.md))

***

### `potionUseFlag`
<div class="search_terms" style="display: none">potionuseflag</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `selectedAction`
<div class="search_terms" style="display: none">selectedaction</div>

The current combat action, until the next AI decision. This can be changed to affect what the AI is doing in the short term. From observed behavior, this roughly maps to:

Value | Behavior
----- | ---------
0     | Undecided
1     | Use melee weapon
2     | Use marksman weapon
3     | Use hand to hand attacks
4     | Use on-touch offensive spell
5     | Use on-target offensive spell
6     | Use summon spell
7     | Flee
8     | Cast on-self empowering spell (For example, Ancestor Guardian)
9     | Use alchemy item
10    | Use enchanted item


**Returns**:

* `result` (integer)

***

### `selectedItem`
<div class="search_terms" style="display: none">selecteditem</div>

The potion or an enchanted item which was chosen at the last AI decision, if it was a magic item action. Changing this has no effect outside of the decision function, instead use `tes3mobileActor.equipMagic` to change the next castable.

**Returns**:

* `result` ([tes3itemStack](../types/tes3itemStack.md))

***

### `selectedShield`
<div class="search_terms" style="display: none">selectedshield</div>

*Read-only*. The shield which was chosen at the last physical attack AI decision.

**Returns**:

* `result` ([tes3equipmentStack](../types/tes3equipmentStack.md))

***

### `selectedSpell`
<div class="search_terms" style="display: none">selectedspell</div>

The spell which was chosen at the last AI decision, if it was a spell cast action. Changing this has no effect outside of the decision function, instead use `tes3mobileActor.equipMagic` to change the next castable.

**Returns**:

* `result` ([tes3spell](../types/tes3spell.md))

***

### `selectedWeapon`
<div class="search_terms" style="display: none">selectedweapon</div>

*Read-only*. The weapon which was chosen at the last physical attack AI decision.

**Returns**:

* `result` ([tes3equipmentStack](../types/tes3equipmentStack.md))

***

### `spellPriority`
<div class="search_terms" style="display: none">spellpriority</div>

No description yet available.

**Returns**:

* `result` (number)

***

## Methods

### `changeEquipment`
<div class="search_terms" style="display: none">changeequipment</div>

This method equips an item to the mobile in this combat sesion.

```lua
myObject:changeEquipment(equipmentStack)
```

**Parameters**:

* `equipmentStack` ([tes3equipmentStack](../types/tes3equipmentStack.md)): An item to equip.

***

### `selectAlchemyWithEffect`
<div class="search_terms" style="display: none">selectalchemywitheffect</div>

Selects the alchemy item with the greatest value, for a given effect ID and loads it into the `selectedItem` property.

```lua
local result = myObject:selectAlchemyWithEffect(id)
```

**Parameters**:

* `id` ([tes3.effect](../references/magic-effects.md), integer): Maps to values in [`tes3.effect`](https://mwse.github.io/MWSE/references/magic-effects/) table.

**Returns**:

* `result` (number)

